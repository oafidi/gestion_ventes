@startuml DA02 - Processus Commande

!theme plain
title <size:20>**DA02 - Processus de Commande**</size>\n<size:14>//De la navigation Ã  la confirmation d'achat//</size>

skinparam backgroundColor #FEFEFE
skinparam ActivityBackgroundColor #E3F2FD
skinparam ActivityBorderColor #1976D2
skinparam ActivityDiamondBackgroundColor #FFF3E0
skinparam ActivityDiamondBorderColor #F57C00
skinparam ArrowColor #1976D2

|#FFF3E0| ğŸ›’ Client |
|#E3F2FD| ğŸª Boutique |
|#E8F5E9| ğŸ“¦ Gestion Stock |
|#FCE4EC| ğŸ“‹ Gestion Commandes |

start

|ğŸ›’ Client|
:AccÃ©der Ã  la boutique en ligne;

|ğŸª Boutique|
:Afficher le catalogue de produits;

|ğŸ›’ Client|
repeat
    :Parcourir les produits;
    :Consulter une fiche produit;
    
    note right
        **Informations visibles :**
        â€¢ Description du produit
        â€¢ Prix des diffÃ©rents vendeurs
        â€¢ Note moyenne (â­)
        â€¢ DisponibilitÃ©
    end note
    
    if (Produit intÃ©ressant ?) then (Oui)
        :SÃ©lectionner la quantitÃ©;
        :Choisir le vendeur;
        
        |ğŸ“¦ Gestion Stock|
        :VÃ©rifier la disponibilitÃ©;
        
        if (Stock suffisant ?) then (Oui)
            |ğŸ›’ Client|
            :â• Ajouter au panier;
            
            |ğŸª Boutique|
            :Mettre Ã  jour le panier;
            :Afficher confirmation;
        else (Non)
            |ğŸª Boutique|
            :âš ï¸ Afficher "Stock insuffisant"\nQuantitÃ© disponible : X;
            
            |ğŸ›’ Client|
            :Ajuster la quantitÃ©;
        endif
    else (Non)
        |ğŸ›’ Client|
    endif
    
repeat while (Continuer les achats ?) is (Oui)
-> Non;

|ğŸ›’ Client|
:ğŸ›ï¸ AccÃ©der au panier;

|ğŸª Boutique|
:Afficher le rÃ©capitulatif du panier;

note right
    **RÃ©capitulatif :**
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Produit A  x2  50â‚¬ â”‚
    â”‚ Produit B  x1  30â‚¬ â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚ **TOTAL : 80â‚¬**    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
end note

|ğŸ›’ Client|
if (Panier OK ?) then (Non)
    :Modifier les quantitÃ©s;
    :Supprimer des articles;
else (Oui)
    :ProcÃ©der au paiement;
endif

|ğŸª Boutique|
:Demander l'adresse de livraison;

|ğŸ›’ Client|
:Saisir / Confirmer l'adresse;

|ğŸ“‹ Gestion Commandes|
fork
    :Calculer le montant total;
fork again
    :VÃ©rifier les informations client;
end fork

|ğŸ“¦ Gestion Stock|
:RÃ©server le stock pour chaque article;

if (RÃ©servation rÃ©ussie ?) then (Oui)
    
    |ğŸ“‹ Gestion Commandes|
    :ğŸ“‹ CrÃ©er la commande;
    
    note right
        **Commande crÃ©Ã©e :**
        â€¢ NÂ° : CMD-2024-0042
        â€¢ Statut : EN_ATTENTE
        â€¢ Date : 28/12/2024
        â€¢ Montant : 80â‚¬
    end note
    
    :ğŸ“§ Envoyer confirmation par email;
    
    |ğŸ›’ Client|
    :âœ… Recevoir la confirmation;
    :ğŸ‰ "Commande passÃ©e avec succÃ¨s !";
    
else (Non)
    
    |ğŸ“‹ Gestion Commandes|
    :âŒ Annuler la transaction;
    
    |ğŸª Boutique|
    :Afficher erreur de stock;
    
    |ğŸ›’ Client|
    :Retourner au panier\npour ajuster;
    stop
    
endif

stop

legend right
    **RÃ¨gles mÃ©tier :**
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    â€¢ Stock vÃ©rifiÃ© Ã  l'ajout au panier
    â€¢ Stock rÃ©servÃ© Ã  la confirmation
    â€¢ Email de confirmation automatique
    â€¢ Commande crÃ©Ã©e en statut EN_ATTENTE
endlegend

@enduml
