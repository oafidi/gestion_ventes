@startuml DA09 - Cycle Vie Commande

!theme plain
title <size:20>**DA09 - Cycle de Vie d'une Commande**</size>\n<size:14>//Tous les Ã©tats et transitions possibles//</size>

skinparam backgroundColor #FEFEFE
skinparam ActivityBackgroundColor #E3F2FD
skinparam ActivityBorderColor #1976D2
skinparam ActivityDiamondBackgroundColor #FFF3E0
skinparam ActivityDiamondBorderColor #F57C00
skinparam ArrowColor #1976D2

|#FFF3E0| ğŸ›’ Client |
|#E3F2FD| ğŸ“‹ Commande |
|#E8F5E9| ğŸ›¡ï¸ Admin |
|#FCE4EC| ğŸšš Livraison |

start

|ğŸ›’ Client|
:Passer une commande;

|ğŸ“‹ Commande|
#Yellow:ğŸŸ¡ **EN_ATTENTE**;

note right
    **Ã‰tat initial :**
    La commande vient d'Ãªtre crÃ©Ã©e
    et attend le traitement admin
end note

fork
    |ğŸ›’ Client|
    :ğŸ“§ Email de confirmation;
fork again
    |ğŸ“‹ Commande|
    :Stock rÃ©servÃ©;
end fork

|ğŸ›¡ï¸ Admin|
:Examiner la commande;

switch (DÃ©cision admin ?)

case (âœ… Confirmer)
    
    |ğŸ“‹ Commande|
    #LightGreen:ğŸŸ¢ **CONFIRMÃ‰E**;
    
    note right
        **Transition :**
        EN_ATTENTE â†’ CONFIRMÃ‰E
        La commande est validÃ©e
    end note
    
    |ğŸ›’ Client|
    :ğŸ“§ "Commande confirmÃ©e !";
    
    |ğŸ›¡ï¸ Admin|
    :PrÃ©parer le colis;
    :Transmettre au transporteur;
    
    |ğŸ“‹ Commande|
    #LightBlue:ğŸ”µ **EN_COURS_LIVRAISON**;
    
    note right
        **Transition :**
        CONFIRMÃ‰E â†’ EN_COURS_LIVRAISON
        Le colis est en route
    end note
    
    |ğŸ›’ Client|
    :ğŸ“§ "Colis expÃ©diÃ© !"\nNÂ° suivi : TRK-XXX;
    
    |ğŸšš Livraison|
    :Acheminer le colis;
    :Livrer au client;
    
    if (Livraison rÃ©ussie ?) then (Oui)
        
        |ğŸ“‹ Commande|
        #PaleGreen:âœ… **LIVRÃ‰E**;
        
        note right
            **Ã‰tat final :**
            EN_COURS_LIVRAISON â†’ LIVRÃ‰E
            Commande terminÃ©e avec succÃ¨s
        end note
        
        |ğŸ›’ Client|
        :ğŸ“§ "Commande livrÃ©e !"\nâ­ Donnez votre avis;
        
        :PossibilitÃ© de donner un avis;
        note right
            â†’ Voir DA06
            Processus d'avis
        end note
        
    else (Non - ProblÃ¨me)
        
        |ğŸšš Livraison|
        :Signaler le problÃ¨me;
        
        switch (Type de problÃ¨me ?)
        case (Client absent)
            :Programmer nouvelle livraison;
        case (Adresse incorrecte)
            |ğŸ›¡ï¸ Admin|
            :Contacter le client;
            :Mettre Ã  jour l'adresse;
        case (Colis perdu/endommagÃ©)
            |ğŸ›¡ï¸ Admin|
            :Ouvrir un litige;
            :Initier le remboursement;
        endswitch
        
    endif

case (âŒ Annuler)
    
    |ğŸ“‹ Commande|
    #LightPink:âŒ **ANNULÃ‰E**;
    
    note right
        **Ã‰tat final :**
        EN_ATTENTE â†’ ANNULÃ‰E
        Commande non traitÃ©e
    end note
    
    fork
        :Restaurer le stock;
    fork again
        :Initier le remboursement;
    end fork
    
    |ğŸ›’ Client|
    :ğŸ“§ "Commande annulÃ©e"\nğŸ’° Remboursement en cours;

endswitch

|ğŸ“‹ Commande|
:Archiver la commande;

stop

' ===== DIAGRAMME D'Ã‰TATS =====
legend right
    **Diagramme d'Ã©tats :**
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ ğŸŸ¡ EN_ATTENTE â”‚
         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
        â†“               â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ğŸŸ¢ CONFâ”‚     â”‚âŒ ANNUL â”‚
    â””â”€â”€â”€â”¬â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ğŸ”µ EN_LIVRAISON â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ âœ… LIVRÃ‰E â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
endlegend

@enduml
