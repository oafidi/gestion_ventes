@startuml DS01 - Authentification

!theme plain
title <size:20>**DS01 - Authentification Utilisateur**</size>\n<size:14>//Processus de connexion et gestion des acc√®s//</size>

skinparam backgroundColor #FEFEFE
skinparam handwritten false
skinparam sequenceMessageAlign center
skinparam responseMessageBelowArrow true
skinparam maxMessageSize 200
skinparam wrapWidth 200

skinparam participant {
    BackgroundColor #E3F2FD
    BorderColor #1976D2
    FontColor #1565C0
}

skinparam actor {
    BackgroundColor #FFF3E0
    BorderColor #F57C00
}

skinparam note {
    BackgroundColor #FFFDE7
    BorderColor #FBC02D
}

actor "üë§ Utilisateur\n(Client/Vendeur/Admin)" as U #FFF3E0
participant "üñ•Ô∏è Page\nConnexion" as P #E3F2FD
participant "üîê Syst√®me\nAuthentification" as G #E8F5E9

note over U, G #E1F5FE
    **Objectif m√©tier** : Permettre aux utilisateurs
    d'acc√©der √† leur espace personnel selon leur r√¥le
end note

== üìù INSCRIPTION - Nouveau Compte ==

U -> P: Demande d'inscription
activate P #BBDEFB
P --> U: Formulaire d'inscription
deactivate P

note right of U #FFFDE7
    **Informations requises :**
    ‚Ä¢ Nom complet
    ‚Ä¢ Adresse email
    ‚Ä¢ Mot de passe
    ‚Ä¢ R√¥le souhait√© (Client/Vendeur)
    ‚Ä¢ T√©l√©phone
end note

U -> P: Soumet les informations
activate P #BBDEFB
P -> G: V√©rifie disponibilit√© email
activate G #C8E6C9

alt #FFEBEE <color:#C62828>‚ùå Email d√©j√† utilis√©</color>
    G --> P: Email existant
    P --> U: **Erreur** : Cet email est d√©j√† associ√© √† un compte
    deactivate G
    deactivate P
else #E8F5E9 <color:#2E7D32>‚úÖ Email disponible</color>
    G -> G: Cr√©ation du compte
    note right of G #E8F5E9
        Le vendeur est cr√©√©
        avec **estApprouve = false**
        (n√©cessite validation Admin)
    end note
    G --> P: Compte cr√©√© avec succ√®s
    deactivate G
    P --> U: **Bienvenue !**\nRedirection vers votre espace
    deactivate P
end

|||

== üîë CONNEXION - Acc√®s au Compte ==

U -> P: Saisie email + mot de passe
activate P #BBDEFB
P -> G: V√©rification des identifiants
activate G #C8E6C9

alt #FFEBEE <color:#C62828>‚ùå √âchec d'authentification</color>
    G --> P: Identifiants invalides
    P --> U: **Erreur** : Email ou mot de passe incorrect
    deactivate G
    deactivate P
else #E8F5E9 <color:#2E7D32>‚úÖ Authentification r√©ussie</color>
    G --> P: Utilisateur authentifi√© + R√¥le
    deactivate G
    
    alt R√¥le = ADMIN
        P --> U: üõ°Ô∏è Redirection ‚Üí **Tableau de bord Admin**
    else R√¥le = VENDEUR
        P --> U: üè™ Redirection ‚Üí **Espace Vendeur**
    else R√¥le = CLIENT
        P --> U: üõí Redirection ‚Üí **Boutique & Mon Compte**
    end
    deactivate P
end

|||

== üö™ D√âCONNEXION ==

U -> P: Clic sur "D√©connexion"
activate P #BBDEFB
P -> G: Fermeture de session
activate G #C8E6C9
G -> G: Invalidation du token
G --> P: Session termin√©e
deactivate G
P --> U: Retour √† l'accueil\n**√Ä bient√¥t !**
deactivate P

note over U, G #E1F5FE
    **R√®gles m√©tier :**
    ‚Ä¢ Un vendeur doit √™tre approuv√© par l'admin pour vendre
    ‚Ä¢ Chaque r√¥le a des droits sp√©cifiques
    ‚Ä¢ Session s√©curis√©e avec expiration automatique
end note

@enduml