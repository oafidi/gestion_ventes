@startuml DS02 - Passer Commande

!theme plain
title <size:20>**DS02 - Processus de Commande**</size>\n<size:14>//Du panier √† la confirmation de commande//</size>

skinparam backgroundColor #FEFEFE
skinparam sequenceMessageAlign center
skinparam responseMessageBelowArrow true
skinparam maxMessageSize 200

skinparam participant {
    BackgroundColor #E3F2FD
    BorderColor #1976D2
    FontColor #1565C0
}

skinparam actor {
    BackgroundColor #FFF3E0
    BorderColor #F57C00
}

actor "üõí Client" as C #FFF3E0
participant "üè™ Boutique" as B #E3F2FD
participant "üì¶ Panier" as P #FFF3E0
participant "üìã Commande" as CMD #E8F5E9
participant "üìä Stock" as S #FCE4EC

note over C, S #E1F5FE
    **Objectif m√©tier** : Permettre au client de 
    s√©lectionner des produits et passer une commande
end note

== üîç PHASE 1 : Navigation et S√©lection ==

C -> B: Parcours du catalogue
activate B #BBDEFB
B --> C: Affichage des produits disponibles\n(avec prix, images, vendeurs)
deactivate B

C -> B: S√©lection d'un produit
activate B #BBDEFB
B --> C: **Fiche produit d√©taill√©e**
deactivate B

note right of C #FFFDE7
    **Le client voit :**
    ‚Ä¢ Nom et description
    ‚Ä¢ Prix du vendeur
    ‚Ä¢ Note moyenne (‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ)
    ‚Ä¢ Quantit√© disponible
end note

|||

== üõçÔ∏è PHASE 2 : Constitution du Panier ==

C -> P: Ajouter au panier\n(produit + quantit√©)
activate P #FFE0B2
P -> S: V√©rification disponibilit√© imm√©diate
activate S #F8BBD9

alt #FFEBEE <color:#C62828>Stock insuffisant</color>
    S --> P: Quantit√© non disponible
    P --> C: **‚ö†Ô∏è Stock limit√©**\nSeulement X unit√©s disponibles
else #E8F5E9 <color:#2E7D32>Stock OK</color>
    S --> P: Quantit√© disponible
    deactivate S
    P -> P: Mise √† jour du panier
    P --> C: **‚úÖ Produit ajout√© !**\nPanier : X articles - Total : XX ‚Ç¨
    deactivate P
end

C -> P: Consulter le panier
activate P #FFE0B2
P --> C: **R√©capitulatif du panier**
deactivate P

note right of P #FFFDE7
    **Contenu du panier :**
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ Produit A      x2    50 ‚Ç¨  ‚îÇ
    ‚îÇ Produit B      x1    30 ‚Ç¨  ‚îÇ
    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
    ‚îÇ **TOTAL           80 ‚Ç¨**   ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
end note

|||

== ‚úÖ PHASE 3 : Validation de la Commande ==

C -> P: Proc√©der au paiement
activate P #FFE0B2
P --> C: Formulaire adresse de livraison
deactivate P

C -> CMD: Confirmation de commande
activate CMD #C8E6C9

CMD -> S: R√©servation d√©finitive du stock
activate S #F8BBD9
S -> S: D√©cr√©mentation des quantit√©s
S --> CMD: Stock r√©serv√©
deactivate S

CMD -> CMD: Cr√©ation de la commande

note right of CMD #E8F5E9
    **Commande cr√©√©e :**
    ‚Ä¢ N¬∞ : CMD-2024-0042
    ‚Ä¢ Statut : **EN_ATTENTE**
    ‚Ä¢ Date : 28/12/2024
    ‚Ä¢ Client : [Nom du client]
    ‚Ä¢ Montant : 80 ‚Ç¨
end note

CMD --> C: **üéâ Commande confirm√©e !**\nNum√©ro : CMD-2024-0042\nStatut : En attente de traitement
deactivate CMD

|||

note over C, S #E1F5FE
    **R√®gles m√©tier :**
    ‚Ä¢ Le stock est r√©serv√© d√®s la confirmation
    ‚Ä¢ Le client peut suivre sa commande
    ‚Ä¢ L'admin peut changer le statut
end note

@enduml